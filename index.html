<html>
<head>
<title>Istid</title>
<script src="phonegap.js"></script>

<script language="javascript">


	IAP = {
	  list: [ "year", "test"]
	};

	IAP.load = function () {
	 //

	     // Check availability of the storekit plugin
	     if (!window.storekit) {
	          alert("In-App Purchases not available");

	          return;
	     }
	 
	     // Initialize
	     storekit.init({
	          debug:    true, // Enable IAP messages on the console
	          ready:    IAP.onReady,
	          purchase: IAP.onPurchase,
	          restore:  IAP.onRestore,
	          error:    IAP.onError
	     });
	 
	};

	IAP.onReady = function () {
	     storekit.load(IAP.list, function (products, invalidIds) {
	          IAP.products = products;
	          IAP.loaded = true;
	          for (var i = 0; i < invalidIds.length; ++i) {
	               console.log("Error: could not load " + invalidIds[i]);
	          }
	     });
	};
	IAP.onPurchase = function (transactionId, productId, receipt) {
		alert("foo");
	     if(productId === 'year'){
	          alert("Ads Removed!");
	          //Code to remove ads for the user
	     }
	};
	IAP.onRestore = function (transactionId, productId, transactionReceipt) {
		alert("foobar");
	     if(productId == 'year'){
	          //Code to remove ads for the user
	     }
	};
	IAP.onError = function (errorCode, errorMessage) {
	     alert(errorCode);
	     alert(errorMessage);
	};
	IAP.buy = function(productId){
		console.log("wef");
		//if (navigator.notification.confirm("Vill du köpa ett års abonnemang för ditt lag? Konstad 399 kr", , "Konfirmera ditt In-App köp")) {
	     storekit.purchase(productId);
		//} 
	};
	IAP.restore = function(){
	     storekit.restore();
	};

    // Wait for device API libraries to load
    //
    function onLoad() {
    			console.log("start");
        document.addEventListener("deviceready", onDeviceReady, false);
    }

    // device APIs are available
    //
    function onDeviceReady() {
    	IAP.load();

        // Now safe to use device APIs
    var push = PushNotification.init({ "android": {"senderID": "392298657548", "sound": "true", "forceShow": "true"}, 
        "ios": {"alert": "true", "sound": "true"} } );


        push.on('registration', function(data) {
            // data.registrationId
            //alert(data.registrationId);
            //document.write(data.registrationId);
        //   window.location.href="http://team05.hahc.se/?regid="+data.registrationId
        });

        push.on('notification', function(data) {
            // data.message,
            // data.title,
            // data.count,
            // data.sound,
            // data.image,
            // data.additionalData
        //    alert("not");

            //alert(data.message);
        });

        push.on('error', function(e) {
            // e.message
            //alert("error");
          //  window.location.href="http://team05.hahc.se/"
        });
    }



   
</script>
    </head>
      <style>
      body {
        background-color: #EFEFEF;
        color: #fff;
        text-align: center;
        font-family: arial, sans-serif;
        margin: 0;
      }
      a {
            color: #fff;

      }
      </style>
    </head>

      <body onload="onLoad()" style="background-color:#860136">

        <div style="margin-top:20%; background-color: #860136;">
        <center>
        <img src="Haninge_Anchors_HC_logo.png"/>
        <h3>Köp ett års abonnemang för ditt lag </h3>
  
        <br/>
         <button onclick="IAP.buy('year');">Köp ett års abonnemang</button>
        <br/>
        <span style="font-size:12px">
        Vid frågor kontakta conny@shoogle.se
        </span>
        <br/>
        <br/>
        <a href="/">Gå till startsidan</a>
        </center>
        </div>
      </body>
      <!-- This file lives in public/404.html -->

    </body>
  
  </body>

</html>
