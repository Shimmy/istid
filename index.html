<html>
<head>
<title>Istid</title>
<script src="phonegap.js"></script>

<script language="javascript">

    function onLoad() {
    	console.log("start");
        document.addEventListener("deviceready", onDeviceReady, false);
    }

    // device APIs are available
    //
    function onDeviceReady() {
    	IAP.load();
    }

    var IAP = {
        list: [ 'year' ],
        products: {}
    };
    var localStorage = window.localStorage || {};

    IAP.initialize = function () {
        // Check availability of the storekit plugin
        if (!window.storekit) {
            console.log('In-App Purchases not available');
            return;
        }

        // Initialize
        storekit.init({
            debug:    true,
            noAutoFinish: true,
            ready:    IAP.onReady,
            purchase: IAP.onPurchase,
            finish:   IAP.onFinish,
            restore:  IAP.onRestore,
            error:    IAP.onError,
            restoreCompleted: IAP.onRestoreCompleted
        });
    };

    IAP.onReady = function () {
        // Once setup is done, load all product data.
        storekit.load(IAP.list, function (products, invalidIds) {
            alert('IAPs loading done:');
            for (var j = 0; j < products.length; ++j) {
                var p = products[j];
                alert('Loaded IAP(' + j + '). title:' + p.title +
                            ' description:' + p.description +
                            ' price:' + p.price +
                            ' id:' + p.id);
                IAP.products[p.id] = p;
            }
            IAP.loaded = true;
            for (var i = 0; i < invalidIds.length; ++i) {
                alert('Error: could not load ' + invalidIds[i]);
            }
            IAP.render();
        });

        // Also check the receipts
        // storekit.loadReceipts(function (receipts) {
        //     console.log('appStoreReceipt: ' + receipts.appStoreReceipt);
        // });
    };

    IAP.onPurchase = function (transactionId, productId) {
        var n = (localStorage['storekit.' + productId]|0) + 1;
        localStorage['storekit.' + productId] = n;
        if (IAP.purchaseCallback) {
            IAP.purchaseCallback(productId);
            delete IAP.purchaseCallbackl;
        }

        storekit.finish(transactionId);

        storekit.loadReceipts(function (receipts) {
            console.log('Receipt for appStore = ' + receipts.appStoreReceipt);
            console.log('Receipt for ' + productId + ' = ' + receipts.forProduct(productId));
        });
    };

    IAP.onFinish = function (transactionId, productId) {
        console.log('Finished transaction for ' + productId + ' : ' + transactionId);
    };

    IAP.onError = function (errorCode, errorMessage) {
        alert('Error: ' + errorMessage);
    };

    IAP.onRestore = function (transactionId, productId) {
        console.log("Restored: " + productId);
        var n = (localStorage['storekit.' + productId]|0) + 1;
        localStorage['storekit.' + productId] = n;
    };

    IAP.onRestoreCompleted = function () {
        console.log("Restore Completed");
    };

    IAP.buy = function (productId, callback) {
        IAP.purchaseCallback = callback;
        storekit.purchase(productId);
    };

    IAP.restore = function () {
        storekit.restore();
    };

    IAP.fullVersion = function () {
        return localStorage['storekit.babygooinapp1'];
    };
   
</script>
    </head>
      <style>
      body {
        background-color: #EFEFEF;
        color: #fff;
        text-align: center;
        font-family: arial, sans-serif;
        margin: 0;
      }
      a {
            color: #fff;

      }
      </style>
    </head>

      <body onload="onLoad()" style="background-color:#860136">

        <div style="margin-top:20%; background-color: #860136;">
        <center>
        <img src="Haninge_Anchors_HC_logo.png"/>
        <h3>Köp ett års abonnemang för ditt lag </h3>
  
        <br/>
         <button onclick="IAP.buy('year');">Köp ett års abonnemang</button>
        <br/>
        <span style="font-size:12px">
        Vid frågor kontakta conny@shoogle.se
        </span>
        <br/>
        <br/>
        <a href="/">Gå till startsidan</a>
        </center>
        </div>
      </body>
      <!-- This file lives in public/404.html -->

    </body>
  
  </body>

</html>
